<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="vcr">
<title>Configure vcr • vcr</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Configure vcr">
<meta property="og:description" content="vcr">
<meta property="og:image" content="https://docs.ropensci.org/vcr/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">vcr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.2.2.93</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../articles/vcr.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/vcr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Configure vcr</h1>
                        <h4 data-toc-skip class="author">Scott Chamberlain</h4>
            
            <h4 data-toc-skip class="date">2024-03-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/vcr/blob/HEAD/vignettes/configuration.Rmd" class="external-link"><code>vignettes/configuration.Rmd</code></a></small>
      <div class="d-none name"><code>configuration.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="vcr-configuration">vcr configuration<a class="anchor" aria-label="anchor" href="#vcr-configuration"></a>
</h2>
<p><code>vcr</code> configuration</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://docs.ropensci.org/vcr">"vcr"</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://docs.ropensci.org/vcr">"vcr"</a></span><span class="op">)</span></span></code></pre></div>
<p>You can also get the default configuration variables via <code><a href="../reference/vcr_configure.html">vcr_config_defaults()</a></code></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/vcr_configure.html">vcr_config_defaults</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $warn_on_empty_cassette</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $quiet</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $verbose_errors</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $write_disk_path</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $filter_query_parameters</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $filter_response_headers</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $filter_request_headers</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $filter_sensitive_data_regex</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $filter_sensitive_data</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $log_opts</span></span>
<span><span class="co">#&gt; $log_opts$file</span></span>
<span><span class="co">#&gt; [1] "vcr.log"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $log_opts$log_prefix</span></span>
<span><span class="co">#&gt; [1] "Cassette"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $log_opts$date</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $log</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $linked_context</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cassettes</span></span>
<span><span class="co">#&gt; list()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $allow_http_connections_when_no_cassette</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $clean_outdated_http_interactions</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $re_record_interval</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $turned_off</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $preserve_exact_body_bytes</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $uri_parser</span></span>
<span><span class="co">#&gt; [1] "crul::url_parse"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ignore_request</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ignore_localhost</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ignore_hosts</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $persist_with</span></span>
<span><span class="co">#&gt; [1] "FileSystem"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $json_pretty</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $serialize_with</span></span>
<span><span class="co">#&gt; [1] "yaml"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $allow_unused_http_interactions</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $match_requests_on</span></span>
<span><span class="co">#&gt; [1] "method" "uri"   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $record</span></span>
<span><span class="co">#&gt; [1] "once"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $dir</span></span>
<span><span class="co">#&gt; [1] "."</span></span></code></pre></div>
<p>These defaults are set when you load <code>vcr</code> - you can override any of them as described below.</p>
<div class="section level3">
<h3 id="set-configuration-variables">Set configuration variables<a class="anchor" aria-label="anchor" href="#set-configuration-variables"></a>
</h3>
<p>Use <code><a href="../reference/vcr_configure.html">vcr_configure()</a></code> to set configuration variables.</p>
<p>For example, set a single variable:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/vcr_configure.html">vcr_configure</a></span><span class="op">(</span></span>
<span>  dir <span class="op">=</span> <span class="st">"foobar/vcr_cassettes"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;vcr configuration&gt;</span></span>
<span><span class="co">#&gt;   Cassette Dir: foobar/vcr_cassettes</span></span>
<span><span class="co">#&gt;   Record: once</span></span>
<span><span class="co">#&gt;   Serialize with: yaml</span></span>
<span><span class="co">#&gt;   URI Parser: crul::url_parse</span></span>
<span><span class="co">#&gt;   Match Requests on: method, uri</span></span>
<span><span class="co">#&gt;   Preserve Bytes?: FALSE</span></span>
<span><span class="co">#&gt;   Logging?: FALSE</span></span>
<span><span class="co">#&gt;   ignored hosts: </span></span>
<span><span class="co">#&gt;   ignore localhost?: FALSE</span></span>
<span><span class="co">#&gt;   Write disk path:</span></span></code></pre></div>
<p>Or many at once:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/vcr_configure.html">vcr_configure</a></span><span class="op">(</span></span>
<span>  dir <span class="op">=</span> <span class="st">"foobar/vcr_cassettes"</span>,</span>
<span>  record <span class="op">=</span> <span class="st">"all"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;vcr configuration&gt;</span></span>
<span><span class="co">#&gt;   Cassette Dir: foobar/vcr_cassettes</span></span>
<span><span class="co">#&gt;   Record: all</span></span>
<span><span class="co">#&gt;   Serialize with: yaml</span></span>
<span><span class="co">#&gt;   URI Parser: crul::url_parse</span></span>
<span><span class="co">#&gt;   Match Requests on: method, uri</span></span>
<span><span class="co">#&gt;   Preserve Bytes?: FALSE</span></span>
<span><span class="co">#&gt;   Logging?: FALSE</span></span>
<span><span class="co">#&gt;   ignored hosts: </span></span>
<span><span class="co">#&gt;   ignore localhost?: FALSE</span></span>
<span><span class="co">#&gt;   Write disk path:</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="re-set-to-defaults">Re-set to defaults<a class="anchor" aria-label="anchor" href="#re-set-to-defaults"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/vcr_configure.html">vcr_configure_reset</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="details-on-some-of-the-config-options">Details on some of the config options<a class="anchor" aria-label="anchor" href="#details-on-some-of-the-config-options"></a>
</h3>
<div class="section level4">
<h4 id="dir">dir<a class="anchor" aria-label="anchor" href="#dir"></a>
</h4>
<p>Directory where cassettes are stored</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/vcr_configure.html">vcr_configure</a></span><span class="op">(</span>dir <span class="op">=</span> <span class="st">"new/path"</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;vcr configuration&gt;</span></span>
<span><span class="co">#&gt;   Cassette Dir: new/path</span></span>
<span><span class="co">#&gt;   Record: once</span></span>
<span><span class="co">#&gt;   Serialize with: yaml</span></span>
<span><span class="co">#&gt;   URI Parser: crul::url_parse</span></span>
<span><span class="co">#&gt;   Match Requests on: method, uri</span></span>
<span><span class="co">#&gt;   Preserve Bytes?: FALSE</span></span>
<span><span class="co">#&gt;   Logging?: FALSE</span></span>
<span><span class="co">#&gt;   ignored hosts: </span></span>
<span><span class="co">#&gt;   ignore localhost?: FALSE</span></span>
<span><span class="co">#&gt;   Write disk path:</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="record">record<a class="anchor" aria-label="anchor" href="#record"></a>
</h4>
<p>The record mode</p>
<p>One of: ‘all’, ‘none’, ‘new_episodes’, ‘once’. See <code><a href="../reference/recording.html">?recording</a></code> for info on the options</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/vcr_configure.html">vcr_configure</a></span><span class="op">(</span>record <span class="op">=</span> <span class="st">"new_episodes"</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;vcr configuration&gt;</span></span>
<span><span class="co">#&gt;   Cassette Dir: new/path</span></span>
<span><span class="co">#&gt;   Record: new_episodes</span></span>
<span><span class="co">#&gt;   Serialize with: yaml</span></span>
<span><span class="co">#&gt;   URI Parser: crul::url_parse</span></span>
<span><span class="co">#&gt;   Match Requests on: method, uri</span></span>
<span><span class="co">#&gt;   Preserve Bytes?: FALSE</span></span>
<span><span class="co">#&gt;   Logging?: FALSE</span></span>
<span><span class="co">#&gt;   ignored hosts: </span></span>
<span><span class="co">#&gt;   ignore localhost?: FALSE</span></span>
<span><span class="co">#&gt;   Write disk path:</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="match_requests_on">match_requests_on<a class="anchor" aria-label="anchor" href="#match_requests_on"></a>
</h4>
<p>Customize how <code>vcr</code> matches requests</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/vcr_configure.html">vcr_configure</a></span><span class="op">(</span>match_requests_on <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'query'</span>, <span class="st">'headers'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;vcr configuration&gt;</span></span>
<span><span class="co">#&gt;   Cassette Dir: new/path</span></span>
<span><span class="co">#&gt;   Record: new_episodes</span></span>
<span><span class="co">#&gt;   Serialize with: yaml</span></span>
<span><span class="co">#&gt;   URI Parser: crul::url_parse</span></span>
<span><span class="co">#&gt;   Match Requests on: query, headers</span></span>
<span><span class="co">#&gt;   Preserve Bytes?: FALSE</span></span>
<span><span class="co">#&gt;   Logging?: FALSE</span></span>
<span><span class="co">#&gt;   ignored hosts: </span></span>
<span><span class="co">#&gt;   ignore localhost?: FALSE</span></span>
<span><span class="co">#&gt;   Write disk path:</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="allow_unused_http_interactions">allow_unused_http_interactions<a class="anchor" aria-label="anchor" href="#allow_unused_http_interactions"></a>
</h4>
<p>Allow HTTP connections when no cassette</p>
<p>Default is <code>TRUE</code>, and thus does not error when http interactions are unused. You can set to <code>FALSE</code> in which case vcr errors when a cassette is ejected and not all http interactions have been used.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/vcr_configure.html">vcr_configure</a></span><span class="op">(</span>allow_unused_http_interactions <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;vcr configuration&gt;</span></span>
<span><span class="co">#&gt;   Cassette Dir: new/path</span></span>
<span><span class="co">#&gt;   Record: new_episodes</span></span>
<span><span class="co">#&gt;   Serialize with: yaml</span></span>
<span><span class="co">#&gt;   URI Parser: crul::url_parse</span></span>
<span><span class="co">#&gt;   Match Requests on: query, headers</span></span>
<span><span class="co">#&gt;   Preserve Bytes?: FALSE</span></span>
<span><span class="co">#&gt;   Logging?: FALSE</span></span>
<span><span class="co">#&gt;   ignored hosts: </span></span>
<span><span class="co">#&gt;   ignore localhost?: FALSE</span></span>
<span><span class="co">#&gt;   Write disk path:</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="serialize_with">serialize_with<a class="anchor" aria-label="anchor" href="#serialize_with"></a>
</h4>
<p>Which serializer to use: “yaml” or “json”. Note that you can have multiple cassettes with the same name as long as they use different serializers; so if you only want one cassette for a given cassette name, make sure to not switch serializers, or clean up files you no longer need.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/vcr_configure.html">vcr_configure</a></span><span class="op">(</span>serialize_with <span class="op">=</span> <span class="st">"yaml"</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;vcr configuration&gt;</span></span>
<span><span class="co">#&gt;   Cassette Dir: new/path</span></span>
<span><span class="co">#&gt;   Record: new_episodes</span></span>
<span><span class="co">#&gt;   Serialize with: yaml</span></span>
<span><span class="co">#&gt;   URI Parser: crul::url_parse</span></span>
<span><span class="co">#&gt;   Match Requests on: query, headers</span></span>
<span><span class="co">#&gt;   Preserve Bytes?: FALSE</span></span>
<span><span class="co">#&gt;   Logging?: FALSE</span></span>
<span><span class="co">#&gt;   ignored hosts: </span></span>
<span><span class="co">#&gt;   ignore localhost?: FALSE</span></span>
<span><span class="co">#&gt;   Write disk path:</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="persist_with">persist_with<a class="anchor" aria-label="anchor" href="#persist_with"></a>
</h4>
<p>Which persister to use. Right now only option is “FileSystem”</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/vcr_configure.html">vcr_configure</a></span><span class="op">(</span>persist_with <span class="op">=</span> <span class="st">"FileSystem"</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;vcr configuration&gt;</span></span>
<span><span class="co">#&gt;   Cassette Dir: new/path</span></span>
<span><span class="co">#&gt;   Record: new_episodes</span></span>
<span><span class="co">#&gt;   Serialize with: yaml</span></span>
<span><span class="co">#&gt;   URI Parser: crul::url_parse</span></span>
<span><span class="co">#&gt;   Match Requests on: query, headers</span></span>
<span><span class="co">#&gt;   Preserve Bytes?: FALSE</span></span>
<span><span class="co">#&gt;   Logging?: FALSE</span></span>
<span><span class="co">#&gt;   ignored hosts: </span></span>
<span><span class="co">#&gt;   ignore localhost?: FALSE</span></span>
<span><span class="co">#&gt;   Write disk path:</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="ignoring-some-requests">ignoring some requests<a class="anchor" aria-label="anchor" href="#ignoring-some-requests"></a>
</h4>
<p><strong>ignore_hosts</strong></p>
<p>Specify particular hosts to ignore. By ignore, we mean that real HTTP requests to the ignored host will be allowed to occur, while all others will not.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/vcr_configure.html">vcr_configure</a></span><span class="op">(</span>ignore_hosts <span class="op">=</span> <span class="st">"google.com"</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;vcr configuration&gt;</span></span>
<span><span class="co">#&gt;   Cassette Dir: new/path</span></span>
<span><span class="co">#&gt;   Record: new_episodes</span></span>
<span><span class="co">#&gt;   Serialize with: yaml</span></span>
<span><span class="co">#&gt;   URI Parser: crul::url_parse</span></span>
<span><span class="co">#&gt;   Match Requests on: query, headers</span></span>
<span><span class="co">#&gt;   Preserve Bytes?: FALSE</span></span>
<span><span class="co">#&gt;   Logging?: FALSE</span></span>
<span><span class="co">#&gt;   ignored hosts: google.com</span></span>
<span><span class="co">#&gt;   ignore localhost?: FALSE</span></span>
<span><span class="co">#&gt;   Write disk path:</span></span></code></pre></div>
<p><strong>ignore_localhost</strong></p>
<p>Ignore all localhost requests</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/vcr_configure.html">vcr_configure</a></span><span class="op">(</span>ignore_localhost <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;vcr configuration&gt;</span></span>
<span><span class="co">#&gt;   Cassette Dir: new/path</span></span>
<span><span class="co">#&gt;   Record: new_episodes</span></span>
<span><span class="co">#&gt;   Serialize with: yaml</span></span>
<span><span class="co">#&gt;   URI Parser: crul::url_parse</span></span>
<span><span class="co">#&gt;   Match Requests on: query, headers</span></span>
<span><span class="co">#&gt;   Preserve Bytes?: FALSE</span></span>
<span><span class="co">#&gt;   Logging?: FALSE</span></span>
<span><span class="co">#&gt;   ignored hosts: google.com</span></span>
<span><span class="co">#&gt;   ignore localhost?: TRUE</span></span>
<span><span class="co">#&gt;   Write disk path:</span></span></code></pre></div>
<p><strong>ignore_request</strong></p>
<p>THIS DOESN’T WORK YET</p>
<p><strong>How to ignore requests</strong></p>
<p>For ignoring requests, you can for example, have real http requests go through (ignored by <code>vcr</code>) while other requests are handled by <code>vcr</code>. For example, let’s say you want requests to <code>google.com</code> to be ignored:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/vcr_configure.html">vcr_configure</a></span><span class="op">(</span>ignore_hosts <span class="op">=</span> <span class="st">"google.com"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/use_cassette.html">use_cassette</a></span><span class="op">(</span><span class="st">"foo_bar"</span>, <span class="op">{</span></span>
<span>  <span class="fu">crul</span><span class="fu">::</span><span class="va"><a href="https://docs.ropensci.org/crul/reference/HttpClient.html" class="external-link">HttpClient</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"https://httpbin.org/get"</span><span class="op">)</span><span class="op">$</span><span class="fu">get</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu">crul</span><span class="fu">::</span><span class="va"><a href="https://docs.ropensci.org/crul/reference/HttpClient.html" class="external-link">HttpClient</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"https://google.com"</span><span class="op">)</span><span class="op">$</span><span class="fu">get</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>The request to httpbin.org will be handled by <code>vcr</code>, a cassette created for the request/response to that url, while the google.com request will be ignored and not cached at all.</p>
<p>Note: ignoring requests only works for the <code>crul</code> package for now; it should work for <code>httr</code> in a later <code>vcr</code> version.</p>
</div>
<div class="section level4">
<h4 id="uri_parse">uri_parse<a class="anchor" aria-label="anchor" href="#uri_parse"></a>
</h4>
<p>Which uri parser to use</p>
<p>By default we use <code><a href="https://docs.ropensci.org/crul/reference/url_build.html" class="external-link">crul::url_parse</a></code>, but you can use a different one. Remember to pass in the function quoted, and namespaced.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/vcr_configure.html">vcr_configure</a></span><span class="op">(</span>uri_parser <span class="op">=</span> <span class="st">"urltools::url_parse"</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;vcr configuration&gt;</span></span>
<span><span class="co">#&gt;   Cassette Dir: new/path</span></span>
<span><span class="co">#&gt;   Record: new_episodes</span></span>
<span><span class="co">#&gt;   Serialize with: yaml</span></span>
<span><span class="co">#&gt;   URI Parser: urltools::url_parse</span></span>
<span><span class="co">#&gt;   Match Requests on: query, headers</span></span>
<span><span class="co">#&gt;   Preserve Bytes?: FALSE</span></span>
<span><span class="co">#&gt;   Logging?: FALSE</span></span>
<span><span class="co">#&gt;   ignored hosts: google.com</span></span>
<span><span class="co">#&gt;   ignore localhost?: TRUE</span></span>
<span><span class="co">#&gt;   Write disk path:</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="preserve_exact_body_bytes">preserve_exact_body_bytes<a class="anchor" aria-label="anchor" href="#preserve_exact_body_bytes"></a>
</h4>
<p>Some HTTP servers are not well-behaved and respond with invalid data. Set <code>preserve_exact_body_bytes</code> to <code>TRUE</code> to base64 encode the result body in order to preserve the bytes exactly as-is. <code>vcr</code> does not do this by default, since base64-encoding the string removes the human readability of the cassette.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/vcr_configure.html">vcr_configure</a></span><span class="op">(</span>preserve_exact_body_bytes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;vcr configuration&gt;</span></span>
<span><span class="co">#&gt;   Cassette Dir: new/path</span></span>
<span><span class="co">#&gt;   Record: new_episodes</span></span>
<span><span class="co">#&gt;   Serialize with: yaml</span></span>
<span><span class="co">#&gt;   URI Parser: urltools::url_parse</span></span>
<span><span class="co">#&gt;   Match Requests on: query, headers</span></span>
<span><span class="co">#&gt;   Preserve Bytes?: TRUE</span></span>
<span><span class="co">#&gt;   Logging?: FALSE</span></span>
<span><span class="co">#&gt;   ignored hosts: google.com</span></span>
<span><span class="co">#&gt;   ignore localhost?: TRUE</span></span>
<span><span class="co">#&gt;   Write disk path:</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="filter_sensitive_data">filter_sensitive_data<a class="anchor" aria-label="anchor" href="#filter_sensitive_data"></a>
</h4>
<p>A named list of values to replace. Sometimes your package or script is working with sensitive tokens/keys, which you do not want to accidentally share with the world.</p>
<p>Before recording (writing to a cassette) we do the replacement and then when reading from the cassette we do the reverse replacement to get back to the real data.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/vcr_configure.html">vcr_configure</a></span><span class="op">(</span></span>
<span>  filter_sensitive_data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"&lt;some_api_key&gt;"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">'MY_API_KEY'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Before recording to disk, the env var <code>MY_API_KEY</code> is retrieved from your machine, and we find instances of it, and replace with <code>&lt;some_api_key&gt;</code>. When replaying to create the HTTP response object we put the real value of the env var back in place.</p>
<p>To target specific request or response headers see <code>filter_request_headers</code> and <code>filter_response_headers</code>.</p>
</div>
<div class="section level4">
<h4 id="filter_request_headers">filter_request_headers<a class="anchor" aria-label="anchor" href="#filter_request_headers"></a>
</h4>
<p>Expects a character vector or a named list. If a character vector, or any unnamed element in a list, the request header is removed before being written to the cassette.</p>
<p>If a named list is passed, the name is the header and the value is the value with which to replace the real value.</p>
<p>A request header you set to remove or replace is only removed/replaced from the cassette, and any requests using a cassette, but will still be in your crul or httr response objects on a real request that creates the cassette.</p>
<p>Examples:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/vcr_configure.html">vcr_configure</a></span><span class="op">(</span></span>
<span>  filter_request_headers <span class="op">=</span> <span class="st">"Authorization"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/vcr_configure.html">vcr_configure</a></span><span class="op">(</span></span>
<span>  filter_request_headers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Authorization"</span>, <span class="st">"User-Agent"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/vcr_configure.html">vcr_configure</a></span><span class="op">(</span></span>
<span>  filter_request_headers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Authorization <span class="op">=</span> <span class="st">"&lt;&lt;&lt;not-my-bearer-token&gt;&gt;&gt;"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="filter_response_headers">filter_response_headers<a class="anchor" aria-label="anchor" href="#filter_response_headers"></a>
</h4>
<p>Expects a character vector or a named list. If a character vector, or any unnamed element in a list, the response header is removed before being written to the cassette.</p>
<p>If a named list is passed, the name is the header and the value is the value with which to replace the real value.</p>
<p>A response header you set to remove or replace is only removed/replaced from the cassette, and any requests using a cassette, but will still be in your crul or httr response objects on a real request that creates the cassette.</p>
<p>Examples:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/vcr_configure.html">vcr_configure</a></span><span class="op">(</span></span>
<span>  filter_response_headers <span class="op">=</span> <span class="st">"server"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/vcr_configure.html">vcr_configure</a></span><span class="op">(</span></span>
<span>  filter_response_headers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"server"</span>, <span class="st">"date"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/vcr_configure.html">vcr_configure</a></span><span class="op">(</span></span>
<span>  filter_response_headers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>server <span class="op">=</span> <span class="st">"fake-server"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="filter_query_parameters">filter_query_parameters<a class="anchor" aria-label="anchor" href="#filter_query_parameters"></a>
</h4>
<p>Expects a character vector or a named list. If a character vector, or any unnamed element in a list, the query parameter is removed (both parameter name and value) before being written to the cassette.</p>
<p>If a named list is passed, the name is the query parameter name and the value is the value with which to replace the real value.</p>
<p>A response header you set to remove or replace is only removed/replaced from the cassette, and any requests using a cassette, but will still be in your crul or httr response objects on a real request that creates the cassette.</p>
<p>Beware of your <code>match_requests_on</code> option when using this filter. If you filter out a query parameter it’s probably a bad idea to match on <code>query</code> given that there is no way for vcr to restore the exact http request from your cassette after one or more query parameters is removed or changed. One way you could filter a query parameter and still match on query or at least on the complete uri is to use replacement behavior (a named list), but instead of <code>list(a="b")</code> use two values <code>list(a=c("b","c"))</code>, where “c” is the string to be stored in the cassette. You could of course replace those values with values from environment variables so that you obscure the real values if your code is public.</p>
<p>Examples:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># completely drop parameter "user"</span></span>
<span><span class="fu"><a href="../reference/vcr_configure.html">vcr_configure</a></span><span class="op">(</span></span>
<span>  filter_query_parameters <span class="op">=</span> <span class="st">"user"</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># completely drop parameters "user" and "api_key"</span></span>
<span><span class="fu"><a href="../reference/vcr_configure.html">vcr_configure</a></span><span class="op">(</span></span>
<span>  filter_query_parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"user"</span>, <span class="st">"api_key"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># replace the value of parameter "api_key" with "fake-api-key"</span></span>
<span><span class="co"># NOTE: in this case there's no way to put back any value on</span></span>
<span><span class="co"># subsequent requests, so we have to match by dropping this</span></span>
<span><span class="co"># parameter value before comparing URIs</span></span>
<span><span class="fu"><a href="../reference/vcr_configure.html">vcr_configure</a></span><span class="op">(</span></span>
<span>  filter_query_parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>api_key <span class="op">=</span> <span class="st">"fake-api-key"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># replace the value found at Sys.getenv("MY_API_KEY") of parameter</span></span>
<span><span class="co"># "api_key" with the value "foo". When using a cassette on subsequent</span></span>
<span><span class="co"># requests, we can replace "foo" with the value at Sys.getenv("MY_API_KEY")</span></span>
<span><span class="co"># before doing the URI comparison</span></span>
<span><span class="fu"><a href="../reference/vcr_configure.html">vcr_configure</a></span><span class="op">(</span></span>
<span>  filter_query_parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>api_key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"MY_API_KEY"</span><span class="op">)</span>, <span class="st">"foo"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="more-documentation">More documentation<a class="anchor" aria-label="anchor" href="#more-documentation"></a>
</h3>
<p>Check out the <a href="https://books.ropensci.org/http-testing/" class="external-link">http testing book</a> for a lot more documentation on <code>vcr</code>, <code>webmockr</code>, and <code>crul</code></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
